#include "Stdafx.h"

#include "Scripts.h"

#include "../Scripts/Script.h"
#include "ScreenLogicBase.h"

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
namespace UI
{

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
static Strong<NScript::Script>& _GetUIScript()
{
  static Strong<NScript::Script> UIScript;

  if ( !UIScript )
  {
    UIScript = new NScript::Script;
  }

  return UIScript;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
NScript::Script *GetUIScript()
{
	return _GetUIScript().Get();
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void ReleaseUIScript()
{
  //Strong<NScript::Script> deleteUIScript = _GetUIScript().Extract();  
  _GetUIScript() = NULL;
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
static bool g_initializedUIScript = false;

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void AddScriptFile( const string & scriptFile )
{
	NI_VERIFY( GetUIScript(), "No scripts!", return );

	if ( !g_initializedUIScript )
	{
		GetUIScript()->DoFile( "UI/Scripts/inc.lua" );
    GetUIScript()->DoFile( "Scripts/inc.lua" );
		g_initializedUIScript = true;
	}

	if ( !scriptFile.empty() )
		GetUIScript()->DoFile( scriptFile );
}

} //namespace UI
