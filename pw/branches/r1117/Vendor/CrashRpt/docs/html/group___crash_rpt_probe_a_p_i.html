<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>CrashRpt: CrashRptProbe Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="style.css" rel="stylesheet" type="text/css">
<link rel="icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>

<div style="padding:10px">
<table border="0" bgcolor="#FFFFFF" cellspacing="5" width="100%">
 <tr>
  <td width="24px" rowspan="2"><img src="../logo.png" alt="Logo" /></td>
  <td><font family="Arial" size="+2">crashrpt</font></td>
  <td rowspan="2" align="right"></td>
 </tr>
 <tr>
  <td colspan="2"><span style="font-size:0.9em"><i>A crash reporting system for Windows applications</i></a></td>
 </tr>
</table>
</div>


<!-- Generated by Doxygen 1.5.9 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Contents</span></a></li>
      <li><a href="modules.html"><span>API&nbsp;Reference</span></a></li>
      <li><a href="files.html"><span>File&nbsp;Reference</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>CrashRptProbe Functions</h1><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g6321942ac8b4635b13300df5219cac6e"></a><!-- doxytag: member="CrashRptProbeAPI::crpOpenErrorReport" ref="g6321942ac8b4635b13300df5219cac6e" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#g6321942ac8b4635b13300df5219cac6e">crpOpenErrorReport</a>&nbsp;&nbsp;&nbsp;crpOpenErrorReportA</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Character set-independent mapping of <a class="el" href="group___crash_rpt_probe_a_p_i.html#g289891358e76eb4223f77ebb6432be2b" title="Opens a zipped crash report file.">crpOpenErrorReportW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#gc3f4c41c487344f5a279525c2d7363ca">crpOpenErrorReportA()</a> functions. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g0e45570a3b25c6c5f8971b3179c5fdbf"></a><!-- doxytag: member="CrashRptProbeAPI::crpGetProperty" ref="g0e45570a3b25c6c5f8971b3179c5fdbf" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#g0e45570a3b25c6c5f8971b3179c5fdbf">crpGetProperty</a>&nbsp;&nbsp;&nbsp;crpGetPropertyA</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Character set-independent mapping of <a class="el" href="group___crash_rpt_probe_a_p_i.html#gdfba1379d47b16d3ea5777badf1cf736" title="Retrieves a string property from crash report.">crpGetPropertyW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#ga2290539d9f2123210f253cbde4f54f1">crpGetPropertyA()</a> functions. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g237fcf61f3027bb315c54bf82e3779d2"></a><!-- doxytag: member="CrashRptProbeAPI::crpExtractFile" ref="g237fcf61f3027bb315c54bf82e3779d2" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#g237fcf61f3027bb315c54bf82e3779d2">crpExtractFile</a>&nbsp;&nbsp;&nbsp;crpExtractFileA</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Character set-independent mapping of <a class="el" href="group___crash_rpt_probe_a_p_i.html#g61b2a967e306ac05d577dea0c51294fc" title="Extracts a file from the opened error report.">crpExtractFileW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#g73e0cc73422096943797a841108d7f1d">crpExtractFileA()</a> functions. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g0d9c05a90d82156c237f6d50bb2157c6"></a><!-- doxytag: member="CrashRptProbeAPI::crpGetLastErrorMsg" ref="g0d9c05a90d82156c237f6d50bb2157c6" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6">crpGetLastErrorMsg</a>&nbsp;&nbsp;&nbsp;crpGetLastErrorMsgA</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines character set-independent mapping for <a class="el" href="group___crash_rpt_probe_a_p_i.html#g6a0f40ab37b99d6af787778c76ad4101" title="Gets the last CrashRptProbe error message.">crpGetLastErrorMsgW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#g841d737c09abc40ed099601bd31259e4">crpGetLastErrorMsgA()</a>. <br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#g289891358e76eb4223f77ebb6432be2b">crpOpenErrorReportW</a> (LPCWSTR pszFileName, LPCWSTR pszMd5Hash, LPCWSTR pszSymSearchPath, DWORD dwFlags, <a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a> *phReport)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Opens a zipped crash report file.  <a href="#g289891358e76eb4223f77ebb6432be2b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#gc3f4c41c487344f5a279525c2d7363ca">crpOpenErrorReportA</a> (LPCSTR pszFileName, LPCSTR pszMd5Hash, LPCSTR pszSymSearchPath, DWORD dwFlags, <a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a> *phReport)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#g0e7fd985622aae142ead686d5380c6c5">crpCloseErrorReport</a> (<a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a> hReport)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Closes the crash report.  <a href="#g0e7fd985622aae142ead686d5380c6c5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#gdfba1379d47b16d3ea5777badf1cf736">crpGetPropertyW</a> (<a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a> hReport, LPCWSTR lpszTableId, LPCWSTR lpszColumnId, INT nRowIndex, LPWSTR lpszBuffer, ULONG cchBuffSize, PULONG pcchCount)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieves a string property from crash report.  <a href="#gdfba1379d47b16d3ea5777badf1cf736"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#ga2290539d9f2123210f253cbde4f54f1">crpGetPropertyA</a> (<a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a> hReport, LPCSTR lpszTableId, LPCSTR lpszColumnId, INT nRowIndex, LPSTR lpszBuffer, ULONG cchBuffSize, PULONG pcchCount)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#g61b2a967e306ac05d577dea0c51294fc">crpExtractFileW</a> (<a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a> hReport, LPCWSTR lpszFileName, LPCWSTR lpszFileSaveAs, BOOL bOverwriteExisting)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extracts a file from the opened error report.  <a href="#g61b2a967e306ac05d577dea0c51294fc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#g73e0cc73422096943797a841108d7f1d">crpExtractFileA</a> (<a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a> hReport, LPCSTR lpszFileName, LPCSTR lpszFileSaveAs, BOOL bOverwriteExisting)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#g6a0f40ab37b99d6af787778c76ad4101">crpGetLastErrorMsgW</a> (LPWSTR pszBuffer, UINT cchBuffSize)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the last CrashRptProbe error message.  <a href="#g6a0f40ab37b99d6af787778c76ad4101"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___crash_rpt_probe_a_p_i.html#g841d737c09abc40ed099601bd31259e4">crpGetLastErrorMsgA</a> (LPSTR pszBuffer, UINT cchBuffSize)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g0e7fd985622aae142ead686d5380c6c5"></a><!-- doxytag: member="CrashRptProbe.h::crpCloseErrorReport" ref="g0e7fd985622aae142ead686d5380c6c5" args="(CrpHandle hReport)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crpCloseErrorReport           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a>&nbsp;</td>
          <td class="paramname"> <em>hReport</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Closes the crash report. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero on success. </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hReport</em>&nbsp;</td><td>Handle to the opened error report.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Use this function to close the error report previously opened with <a class="el" href="group___crash_rpt_probe_a_p_i.html#g6321942ac8b4635b13300df5219cac6e" title="Character set-independent mapping of crpOpenErrorReportW() and crpOpenErrorReportA()...">crpOpenErrorReport()</a> function.<p>
If this function fails, use <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> function to get the error message.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_probe_a_p_i.html#g6321942ac8b4635b13300df5219cac6e" title="Character set-independent mapping of crpOpenErrorReportW() and crpOpenErrorReportA()...">crpOpenErrorReport()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g289891358e76eb4223f77ebb6432be2b" title="Opens a zipped crash report file.">crpOpenErrorReportW()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#gc3f4c41c487344f5a279525c2d7363ca">crpOpenErrorReportA()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="g73e0cc73422096943797a841108d7f1d"></a><!-- doxytag: member="CrashRptProbe.h::crpExtractFileA" ref="g73e0cc73422096943797a841108d7f1d" args="(CrpHandle hReport, LPCSTR lpszFileName, LPCSTR lpszFileSaveAs, BOOL bOverwriteExisting)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crpExtractFileA           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a>&nbsp;</td>
          <td class="paramname"> <em>hReport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>lpszFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>lpszFileSaveAs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BOOL&nbsp;</td>
          <td class="paramname"> <em>bOverwriteExisting</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extracts a file from the opened error report. <p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hReport</em>&nbsp;</td><td>Handle to the opened error report. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpszFileName</em>&nbsp;</td><td>The name of the file to extract. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpszFileSaveAs</em>&nbsp;</td><td>The resulting name of the extracted file. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>bOverwriteExisting</em>&nbsp;</td><td>Overwrite the destination file if it already exists?</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Use this function to extract a compressed file from the error report (ZIP) file.<p>
<em>lpszFileName</em> parameter should be the name of the file to extract. For more information about enumerating file names, see <a class="el" href="crashrptprobe_api_examples.html">Examples of Using CrashRptProbe API</a>.<p>
<em>lpszFileSaveAs</em> defines the name of the file to extract to.<p>
<em>bOverwriteExisting</em> flag defines the behavior when the destination file already exists. If this parameter is TRUE, the file is overwritten, otherwise the function fails.<p>
If this function fails, use <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> to retrieve the error message.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>The <a class="el" href="group___crash_rpt_probe_a_p_i.html#g61b2a967e306ac05d577dea0c51294fc" title="Extracts a file from the opened error report.">crpExtractFileW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#g73e0cc73422096943797a841108d7f1d">crpExtractFileA()</a> are wide character and multibyte character versions of <a class="el" href="group___crash_rpt_probe_a_p_i.html#g237fcf61f3027bb315c54bf82e3779d2" title="Character set-independent mapping of crpExtractFileW() and crpExtractFileA() functions...">crpExtractFile()</a>.</dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_probe_a_p_i.html#g73e0cc73422096943797a841108d7f1d">crpExtractFileA()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g61b2a967e306ac05d577dea0c51294fc" title="Extracts a file from the opened error report.">crpExtractFileW()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g237fcf61f3027bb315c54bf82e3779d2" title="Character set-independent mapping of crpExtractFileW() and crpExtractFileA() functions...">crpExtractFile()</a> </dd></dl>
 
</div>
</div><p>
<a class="anchor" name="g61b2a967e306ac05d577dea0c51294fc"></a><!-- doxytag: member="CrashRptProbe.h::crpExtractFileW" ref="g61b2a967e306ac05d577dea0c51294fc" args="(CrpHandle hReport, LPCWSTR lpszFileName, LPCWSTR lpszFileSaveAs, BOOL bOverwriteExisting)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crpExtractFileW           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a>&nbsp;</td>
          <td class="paramname"> <em>hReport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>lpszFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>lpszFileSaveAs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BOOL&nbsp;</td>
          <td class="paramname"> <em>bOverwriteExisting</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Extracts a file from the opened error report. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero if succeeded.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hReport</em>&nbsp;</td><td>Handle to the opened error report. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpszFileName</em>&nbsp;</td><td>The name of the file to extract. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpszFileSaveAs</em>&nbsp;</td><td>The resulting name of the extracted file. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>bOverwriteExisting</em>&nbsp;</td><td>Overwrite the destination file if it already exists?</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Use this function to extract a compressed file from the error report (ZIP) file.<p>
<em>lpszFileName</em> parameter should be the name of the file to extract. For more information about enumerating file names, see <a class="el" href="crashrptprobe_api_examples.html">Examples of Using CrashRptProbe API</a>.<p>
<em>lpszFileSaveAs</em> defines the name of the file to extract to.<p>
<em>bOverwriteExisting</em> flag defines the behavior when the destination file already exists. If this parameter is TRUE, the file is overwritten, otherwise the function fails.<p>
If this function fails, use <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> to retrieve the error message.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>The <a class="el" href="group___crash_rpt_probe_a_p_i.html#g61b2a967e306ac05d577dea0c51294fc" title="Extracts a file from the opened error report.">crpExtractFileW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#g73e0cc73422096943797a841108d7f1d">crpExtractFileA()</a> are wide character and multibyte character versions of <a class="el" href="group___crash_rpt_probe_a_p_i.html#g237fcf61f3027bb315c54bf82e3779d2" title="Character set-independent mapping of crpExtractFileW() and crpExtractFileA() functions...">crpExtractFile()</a>.</dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_probe_a_p_i.html#g73e0cc73422096943797a841108d7f1d">crpExtractFileA()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g61b2a967e306ac05d577dea0c51294fc" title="Extracts a file from the opened error report.">crpExtractFileW()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g237fcf61f3027bb315c54bf82e3779d2" title="Character set-independent mapping of crpExtractFileW() and crpExtractFileA() functions...">crpExtractFile()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="g841d737c09abc40ed099601bd31259e4"></a><!-- doxytag: member="CrashRptProbe.h::crpGetLastErrorMsgA" ref="g841d737c09abc40ed099601bd31259e4" args="(LPSTR pszBuffer, UINT cchBuffSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crpGetLastErrorMsgA           </td>
          <td>(</td>
          <td class="paramtype">LPSTR&nbsp;</td>
          <td class="paramname"> <em>pszBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UINT&nbsp;</td>
          <td class="paramname"> <em>cchBuffSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the last CrashRptProbe error message. <p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns length of error message in characters.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pszBuffer</em>&nbsp;</td><td>Pointer to the buffer. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cchBuffSize</em>&nbsp;</td><td>Size of buffer in characters.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function gets the last CrashRptProbe error message. You can use this function to retrieve the text status of the last called CrashRptProbe function.<p>
If buffer is too small for the error message, the message is truncated.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd><a class="el" href="group___crash_rpt_probe_a_p_i.html#g6a0f40ab37b99d6af787778c76ad4101" title="Gets the last CrashRptProbe error message.">crpGetLastErrorMsgW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#g841d737c09abc40ed099601bd31259e4">crpGetLastErrorMsgA()</a> are wide-character and multi-byte character versions of <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a>. The <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> macro defines character set independent mapping.</dd></dl>
The following example shows how to use <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> function.<p>
<div class="fragment"><pre class="fragment">  <span class="comment">// .. call some CrashRptProbe function</span>

  <span class="comment">// Get the status message</span>
  TCHAR szErrorMsg[256];
  <a class="code" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg</a>(szErrorMsg, 256);
</pre></div><p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_probe_a_p_i.html#g841d737c09abc40ed099601bd31259e4">crpGetLastErrorMsgA()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g6a0f40ab37b99d6af787778c76ad4101" title="Gets the last CrashRptProbe error message.">crpGetLastErrorMsgW()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> </dd></dl>
 
</div>
</div><p>
<a class="anchor" name="g6a0f40ab37b99d6af787778c76ad4101"></a><!-- doxytag: member="CrashRptProbe.h::crpGetLastErrorMsgW" ref="g6a0f40ab37b99d6af787778c76ad4101" args="(LPWSTR pszBuffer, UINT cchBuffSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crpGetLastErrorMsgW           </td>
          <td>(</td>
          <td class="paramtype">LPWSTR&nbsp;</td>
          <td class="paramname"> <em>pszBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UINT&nbsp;</td>
          <td class="paramname"> <em>cchBuffSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the last CrashRptProbe error message. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns length of error message in characters.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pszBuffer</em>&nbsp;</td><td>Pointer to the buffer. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cchBuffSize</em>&nbsp;</td><td>Size of buffer in characters.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
This function gets the last CrashRptProbe error message. You can use this function to retrieve the text status of the last called CrashRptProbe function.<p>
If buffer is too small for the error message, the message is truncated.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd><a class="el" href="group___crash_rpt_probe_a_p_i.html#g6a0f40ab37b99d6af787778c76ad4101" title="Gets the last CrashRptProbe error message.">crpGetLastErrorMsgW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#g841d737c09abc40ed099601bd31259e4">crpGetLastErrorMsgA()</a> are wide-character and multi-byte character versions of <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a>. The <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> macro defines character set independent mapping.</dd></dl>
The following example shows how to use <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> function.<p>
<div class="fragment"><pre class="fragment">  <span class="comment">// .. call some CrashRptProbe function</span>

  <span class="comment">// Get the status message</span>
  TCHAR szErrorMsg[256];
  <a class="code" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg</a>(szErrorMsg, 256);
</pre></div><p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_probe_a_p_i.html#g841d737c09abc40ed099601bd31259e4">crpGetLastErrorMsgA()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g6a0f40ab37b99d6af787778c76ad4101" title="Gets the last CrashRptProbe error message.">crpGetLastErrorMsgW()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="ga2290539d9f2123210f253cbde4f54f1"></a><!-- doxytag: member="CrashRptProbe.h::crpGetPropertyA" ref="ga2290539d9f2123210f253cbde4f54f1" args="(CrpHandle hReport, LPCSTR lpszTableId, LPCSTR lpszColumnId, INT nRowIndex, LPSTR lpszBuffer, ULONG cchBuffSize, PULONG pcchCount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crpGetPropertyA           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a>&nbsp;</td>
          <td class="paramname"> <em>hReport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>lpszTableId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>lpszColumnId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>nRowIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPSTR&nbsp;</td>
          <td class="paramname"> <em>lpszBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ULONG&nbsp;</td>
          <td class="paramname"> <em>cchBuffSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PULONG&nbsp;</td>
          <td class="paramname"> <em>pcchCount</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Retrieves a string property from crash report. <p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero on success, with one exception (see Remarks for more information).</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hReport</em>&nbsp;</td><td>Handle to the previously opened crash report. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpszTableId</em>&nbsp;</td><td>Table ID. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpszColumnId</em>&nbsp;</td><td>Column ID. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nRowIndex</em>&nbsp;</td><td>Index of the row in the table. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>lpszBuffer</em>&nbsp;</td><td>Output buffer. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cchBuffSize</em>&nbsp;</td><td>Size of the output buffer in characters. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pcchCount</em>&nbsp;</td><td>Count of characters written to the buffer.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Use this function to retrieve data from the crash report that was previously opened with the <a class="el" href="group___crash_rpt_probe_a_p_i.html#g6321942ac8b4635b13300df5219cac6e" title="Character set-independent mapping of crpOpenErrorReportW() and crpOpenErrorReportA()...">crpOpenErrorReport()</a> function.<p>
Properties are organized into tables having rows and columns. For the list of available tables, see <a class="el" href="using_crashrptprobe_api.html">Using CrashRptProbe API</a>.<p>
To get the number of rows in a table, pass the constant <a class="el" href="_crash_rpt_probe_8h.html#37d896e593fa4667d38907b2adb98372">CRP_META_ROW_COUNT</a> as column ID. In this case the function returns number of rows as its return value, or negative value on failure.<p>
In all other cases the function returns zero on success.<p>
Some properties are loaded from crash description XML file, while others are loaded from crash minidump file. The minidump is loaded once when you retrive a property from it. This reduces the overall processing time.<p>
<em>hReport</em> should be the handle to the opened error report.<p>
<em>lpszTableId</em> represente the ID of the table.<p>
<em>lpszColumnId</em> represents the ID of the column in the table.<p>
<em>nRowIndex</em> defines the zero-based index of the row in the table.<p>
<em>lpszBuffer</em> defines the buffer where retrieved property value will be placed. If this parameter is NULL, it is ignored and <em>pcchCount</em> is set with the required size in characters of the buffer.<p>
<em>cchBuffSize</em> defines the buffer size in characters. To calculate required buffer size, set <em>lpszBuffer</em> with NULL, the function will set <em>pcchCount</em> with the number of characters required.<p>
<em>pcchCount</em> is set with the actual count of characters copied to the <em>lpszBuffer</em>. If this parameter is NULL, it is ignored.<p>
If this function fails, use <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> function to get the error message.<p>
For code examples of using this function, see <a class="el" href="crashrptprobe_api_examples.html">Examples of Using CrashRptProbe API</a>.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>The <a class="el" href="group___crash_rpt_probe_a_p_i.html#gdfba1379d47b16d3ea5777badf1cf736" title="Retrieves a string property from crash report.">crpGetPropertyW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#ga2290539d9f2123210f253cbde4f54f1">crpGetPropertyA()</a> are wide character and multibyte character versions of <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0e45570a3b25c6c5f8971b3179c5fdbf" title="Character set-independent mapping of crpGetPropertyW() and crpGetPropertyA() functions...">crpGetProperty()</a>.</dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_probe_a_p_i.html#gdfba1379d47b16d3ea5777badf1cf736" title="Retrieves a string property from crash report.">crpGetPropertyW()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#ga2290539d9f2123210f253cbde4f54f1">crpGetPropertyA()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g6321942ac8b4635b13300df5219cac6e" title="Character set-independent mapping of crpOpenErrorReportW() and crpOpenErrorReportA()...">crpOpenErrorReport()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> </dd></dl>
 
</div>
</div><p>
<a class="anchor" name="gdfba1379d47b16d3ea5777badf1cf736"></a><!-- doxytag: member="CrashRptProbe.h::crpGetPropertyW" ref="gdfba1379d47b16d3ea5777badf1cf736" args="(CrpHandle hReport, LPCWSTR lpszTableId, LPCWSTR lpszColumnId, INT nRowIndex, LPWSTR lpszBuffer, ULONG cchBuffSize, PULONG pcchCount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crpGetPropertyW           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a>&nbsp;</td>
          <td class="paramname"> <em>hReport</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>lpszTableId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>lpszColumnId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT&nbsp;</td>
          <td class="paramname"> <em>nRowIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPWSTR&nbsp;</td>
          <td class="paramname"> <em>lpszBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ULONG&nbsp;</td>
          <td class="paramname"> <em>cchBuffSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PULONG&nbsp;</td>
          <td class="paramname"> <em>pcchCount</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Retrieves a string property from crash report. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero on success, with one exception (see Remarks for more information).</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hReport</em>&nbsp;</td><td>Handle to the previously opened crash report. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpszTableId</em>&nbsp;</td><td>Table ID. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lpszColumnId</em>&nbsp;</td><td>Column ID. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nRowIndex</em>&nbsp;</td><td>Index of the row in the table. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>lpszBuffer</em>&nbsp;</td><td>Output buffer. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>cchBuffSize</em>&nbsp;</td><td>Size of the output buffer in characters. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pcchCount</em>&nbsp;</td><td>Count of characters written to the buffer.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Use this function to retrieve data from the crash report that was previously opened with the <a class="el" href="group___crash_rpt_probe_a_p_i.html#g6321942ac8b4635b13300df5219cac6e" title="Character set-independent mapping of crpOpenErrorReportW() and crpOpenErrorReportA()...">crpOpenErrorReport()</a> function.<p>
Properties are organized into tables having rows and columns. For the list of available tables, see <a class="el" href="using_crashrptprobe_api.html">Using CrashRptProbe API</a>.<p>
To get the number of rows in a table, pass the constant <a class="el" href="_crash_rpt_probe_8h.html#37d896e593fa4667d38907b2adb98372">CRP_META_ROW_COUNT</a> as column ID. In this case the function returns number of rows as its return value, or negative value on failure.<p>
In all other cases the function returns zero on success.<p>
Some properties are loaded from crash description XML file, while others are loaded from crash minidump file. The minidump is loaded once when you retrive a property from it. This reduces the overall processing time.<p>
<em>hReport</em> should be the handle to the opened error report.<p>
<em>lpszTableId</em> represente the ID of the table.<p>
<em>lpszColumnId</em> represents the ID of the column in the table.<p>
<em>nRowIndex</em> defines the zero-based index of the row in the table.<p>
<em>lpszBuffer</em> defines the buffer where retrieved property value will be placed. If this parameter is NULL, it is ignored and <em>pcchCount</em> is set with the required size in characters of the buffer.<p>
<em>cchBuffSize</em> defines the buffer size in characters. To calculate required buffer size, set <em>lpszBuffer</em> with NULL, the function will set <em>pcchCount</em> with the number of characters required.<p>
<em>pcchCount</em> is set with the actual count of characters copied to the <em>lpszBuffer</em>. If this parameter is NULL, it is ignored.<p>
If this function fails, use <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> function to get the error message.<p>
For code examples of using this function, see <a class="el" href="crashrptprobe_api_examples.html">Examples of Using CrashRptProbe API</a>.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd>The <a class="el" href="group___crash_rpt_probe_a_p_i.html#gdfba1379d47b16d3ea5777badf1cf736" title="Retrieves a string property from crash report.">crpGetPropertyW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#ga2290539d9f2123210f253cbde4f54f1">crpGetPropertyA()</a> are wide character and multibyte character versions of <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0e45570a3b25c6c5f8971b3179c5fdbf" title="Character set-independent mapping of crpGetPropertyW() and crpGetPropertyA() functions...">crpGetProperty()</a>.</dd></dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_probe_a_p_i.html#gdfba1379d47b16d3ea5777badf1cf736" title="Retrieves a string property from crash report.">crpGetPropertyW()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#ga2290539d9f2123210f253cbde4f54f1">crpGetPropertyA()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g6321942ac8b4635b13300df5219cac6e" title="Character set-independent mapping of crpOpenErrorReportW() and crpOpenErrorReportA()...">crpOpenErrorReport()</a>, <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> </dd></dl>

</div>
</div><p>
<a class="anchor" name="gc3f4c41c487344f5a279525c2d7363ca"></a><!-- doxytag: member="CrashRptProbe.h::crpOpenErrorReportA" ref="gc3f4c41c487344f5a279525c2d7363ca" args="(LPCSTR pszFileName, LPCSTR pszMd5Hash, LPCSTR pszSymSearchPath, DWORD dwFlags, CrpHandle *phReport)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crpOpenErrorReportA           </td>
          <td>(</td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszMd5Hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCSTR&nbsp;</td>
          <td class="paramname"> <em>pszSymSearchPath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DWORD&nbsp;</td>
          <td class="paramname"> <em>dwFlags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a> *&nbsp;</td>
          <td class="paramname"> <em>phReport</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Opens a zipped crash report file. <p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero on success.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszFileName</em>&nbsp;</td><td>Zipped report file name. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszMd5Hash</em>&nbsp;</td><td>String containing MD5 hash for the ZIP file data. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszSymSearchPath</em>&nbsp;</td><td>Symbol files (PDB) search path. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dwFlags</em>&nbsp;</td><td>Flags, reserved for future use. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>phReport</em>&nbsp;</td><td>Handle to the opened crash report.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Use this function to open a ZIP archive containing an error report. The error report typically contains several compressed files, such as XML crash description file, crash minidump file, and (optionally) application-defined files.<p>
<em>pszFileName</em> should be the name of the error report (ZIP file) to open. Absolute or relative path accepted. This parameter is required.<p>
<em>pszMd5Hash</em> is a string containing the MD5 hash calculated for <em>pszFileName</em>. The MD5 hash is a sequence of 16 characters being used for integrity checks. If this parameter is NULL, integrity check is not performed.<p>
If the error report is delivered by HTTP, the MD5 hash can be extracted by server-side script from the 'md5' parameter. When the error report is delivered by email, the MD5 hash is attached to the mail message. The integrity check can be performed to ensure the error report was not corrupted during delivery. For more information, see <a class="el" href="sending_error_reports.html">Sending Error Reports</a>.<p>
<em>pszSymSearchPath</em> parameter defines where to look for symbols files (*.PDB). You can specify the list of semicolon-separated directories to search in. If this parameter is NULL, the default search sequence is used. For the default search sequence, see the documentation for <b>SymInitialize()</b> function in MSDN.<p>
Symbol files are required for crash report processing. They contain various information used by the debugger. For more information about saving symbol files, see <a class="el" href="preparing_to_software_release.html">Preparing to Software Release</a>.<p>
<em>dwFlags</em> is currently not used, should be zero.<p>
<em>phReport</em> parameter receives the handle to the opened crash report. If the function fails, this parameter becomes zero.<p>
This function does the following when opening report file:<ul>
<li>It performs integrity checks for the error report being opened, if MD5 hash is specified.</li><li>It searches for crashrpt.xml and crashdump.dml files inside of ZIP archive, if such files do not present, it assumes the report was generated by CrashRpt v1.0. In such case it searches for any file having *.dmp or *.xml extension and assumes these are valid XML and DMP file.</li><li>It extracts and loads the XML file and checks its structure.</li><li>It extracts the minidump file to the temporary location.</li></ul>
<p>
On failure, use <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> function to get the last error message.<p>
Use the <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0e7fd985622aae142ead686d5380c6c5" title="Closes the crash report.">crpCloseErrorReport()</a> function to close the opened error report.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd></dd></dl>
The <a class="el" href="group___crash_rpt_probe_a_p_i.html#g289891358e76eb4223f77ebb6432be2b" title="Opens a zipped crash report file.">crpOpenErrorReportW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#gc3f4c41c487344f5a279525c2d7363ca">crpOpenErrorReportA()</a> are wide character and multibyte character versions of <a class="el" href="group___crash_rpt_probe_a_p_i.html#g6321942ac8b4635b13300df5219cac6e" title="Character set-independent mapping of crpOpenErrorReportW() and crpOpenErrorReportA()...">crpOpenErrorReport()</a>.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_probe_a_p_i.html#g0e7fd985622aae142ead686d5380c6c5" title="Closes the crash report.">crpCloseErrorReport()</a> </dd></dl>
 
</div>
</div><p>
<a class="anchor" name="g289891358e76eb4223f77ebb6432be2b"></a><!-- doxytag: member="CrashRptProbe.h::crpOpenErrorReportW" ref="g289891358e76eb4223f77ebb6432be2b" args="(LPCWSTR pszFileName, LPCWSTR pszMd5Hash, LPCWSTR pszSymSearchPath, DWORD dwFlags, CrpHandle *phReport)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int crpOpenErrorReportW           </td>
          <td>(</td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszMd5Hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LPCWSTR&nbsp;</td>
          <td class="paramname"> <em>pszSymSearchPath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DWORD&nbsp;</td>
          <td class="paramname"> <em>dwFlags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_crash_rpt_probe_8h.html#2b2d28276d67dd476ea8aa9c45669d82">CrpHandle</a> *&nbsp;</td>
          <td class="paramname"> <em>phReport</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Opens a zipped crash report file. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>This function returns zero on success.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszFileName</em>&nbsp;</td><td>Zipped report file name. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszMd5Hash</em>&nbsp;</td><td>String containing MD5 hash for the ZIP file data. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszSymSearchPath</em>&nbsp;</td><td>Symbol files (PDB) search path. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>dwFlags</em>&nbsp;</td><td>Flags, reserved for future use. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>phReport</em>&nbsp;</td><td>Handle to the opened crash report.</td></tr>
  </table>
</dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd></dd></dl>
Use this function to open a ZIP archive containing an error report. The error report typically contains several compressed files, such as XML crash description file, crash minidump file, and (optionally) application-defined files.<p>
<em>pszFileName</em> should be the name of the error report (ZIP file) to open. Absolute or relative path accepted. This parameter is required.<p>
<em>pszMd5Hash</em> is a string containing the MD5 hash calculated for <em>pszFileName</em>. The MD5 hash is a sequence of 16 characters being used for integrity checks. If this parameter is NULL, integrity check is not performed.<p>
If the error report is delivered by HTTP, the MD5 hash can be extracted by server-side script from the 'md5' parameter. When the error report is delivered by email, the MD5 hash is attached to the mail message. The integrity check can be performed to ensure the error report was not corrupted during delivery. For more information, see <a class="el" href="sending_error_reports.html">Sending Error Reports</a>.<p>
<em>pszSymSearchPath</em> parameter defines where to look for symbols files (*.PDB). You can specify the list of semicolon-separated directories to search in. If this parameter is NULL, the default search sequence is used. For the default search sequence, see the documentation for <b>SymInitialize()</b> function in MSDN.<p>
Symbol files are required for crash report processing. They contain various information used by the debugger. For more information about saving symbol files, see <a class="el" href="preparing_to_software_release.html">Preparing to Software Release</a>.<p>
<em>dwFlags</em> is currently not used, should be zero.<p>
<em>phReport</em> parameter receives the handle to the opened crash report. If the function fails, this parameter becomes zero.<p>
This function does the following when opening report file:<ul>
<li>It performs integrity checks for the error report being opened, if MD5 hash is specified.</li><li>It searches for crashrpt.xml and crashdump.dml files inside of ZIP archive, if such files do not present, it assumes the report was generated by CrashRpt v1.0. In such case it searches for any file having *.dmp or *.xml extension and assumes these are valid XML and DMP file.</li><li>It extracts and loads the XML file and checks its structure.</li><li>It extracts the minidump file to the temporary location.</li></ul>
<p>
On failure, use <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0d9c05a90d82156c237f6d50bb2157c6" title="Defines character set-independent mapping for crpGetLastErrorMsgW() and crpGetLastErrorMsgA()...">crpGetLastErrorMsg()</a> function to get the last error message.<p>
Use the <a class="el" href="group___crash_rpt_probe_a_p_i.html#g0e7fd985622aae142ead686d5380c6c5" title="Closes the crash report.">crpCloseErrorReport()</a> function to close the opened error report.<p>
<dl class="note" compact><dt><b>Note:</b></dt><dd></dd></dl>
The <a class="el" href="group___crash_rpt_probe_a_p_i.html#g289891358e76eb4223f77ebb6432be2b" title="Opens a zipped crash report file.">crpOpenErrorReportW()</a> and <a class="el" href="group___crash_rpt_probe_a_p_i.html#gc3f4c41c487344f5a279525c2d7363ca">crpOpenErrorReportA()</a> are wide character and multibyte character versions of <a class="el" href="group___crash_rpt_probe_a_p_i.html#g6321942ac8b4635b13300df5219cac6e" title="Character set-independent mapping of crpOpenErrorReportW() and crpOpenErrorReportA()...">crpOpenErrorReport()</a>.<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group___crash_rpt_probe_a_p_i.html#g0e7fd985622aae142ead686d5380c6c5" title="Closes the crash report.">crpCloseErrorReport()</a> </dd></dl>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Mon Apr 8 15:41:10 2013 for CrashRpt by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9</small></address>
</body>
</html>
